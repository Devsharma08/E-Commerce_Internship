<div class="p-5 max-w-6xl flex mx-auto">
  <!-- product card -->

  @if(productList){
  <div class="flex w-full flex-wrap gap-8">
    <!-- Product Image -->
    <!-- <div class="flex flex-col"></div> -->
    <!-- <h1>{{ productList.name }}</h1> -->
    @if(productImagesList.length>1){
    <div class="flex flex-col mt-12 gap-4" (click)="handleImageClick($event)">
      @for( subImg of productImagesList ; track $index ){
      <img
        [src]="subImg"
        [alt]="productList.name"
        class="h-[80px] w-[50px] hover:scale-101 transition-transform duration-300 rounded-sm object-cover"
      />}
    </div>
    }

    <div class="w-full flex flex-col justify-center items-center md:w-1/2">
      <h1 class="text-2xl font-bold mb-2">{{ productList.name }}</h1>
      <img
        [src]="currentImage"
        alt="{{ productList?.name }}"
        class="w-full h-full rounded-lg shadow-lg p-2 hover:scale-101 transition-transform duration-300"
      />
    </div>
  </div>
  }
  <!-- Product Details -->
  <div class="w-full md:w-1/2 flex flex-col gap-4">
    <h1 class="text-3xl font-bold">{{ productList?.name }}</h1>
    <p class="text-lg text-gray-600">{{ productList?.description }}</p>
    <div class="text-2xl font-semibold text-green-600">
      ₹{{ productList?.price }}
    </div>

    <!-- wishlist and cart section -->

    <div class="flex mt-20 justify-around items-center">
      <button
        mat-icon-button
        (click)="addWishList(productList, $event)"
        [ngClass]="{
          'text-red-600': isExists(productId),
          'text-gray-500': !isExists(productId)
        }"
        class="transition duration-200 hover:scale-110"
      >
        <mat-icon class="text-xl">
          {{ isExists(productId) ? "favorite" : "favorite_border" }}
        </mat-icon>
      </button>

      <!-- <button mat-mini-Fab class="text-sm" >
        <mat-icon>shopping_cart</mat-icon>
        <mat-icon class="text-sm">remove_shopping_cart</mat-icon>
      </button> -->

      <button
        mat-raised-button
        color="primary"
        (click)="toggleCart(productList)"
      >
        <mat-icon>{{
          isInCart(productList._id) ? "remove_shopping_cart" : "shopping_cart"
        }}</mat-icon>
        {{ isInCart(productList._id) ? "Remove from Cart" : "Add to Cart" }}
      </button>
    </div>
  </div>

  <!-- similar products -->
</div>
@if(similarProducts.length>1){
<div class="my-10">
  <h2 class="text-2xl font-semibold ml-10 mb-4">Similar Products</h2>
  <div
    class="grid grid-cols-1 sm:grid-cols-2 ml-5 md:grid-cols-3 lg:grid-cols-4 gap-10"
  >
    <app-card *ngFor="let product of similarProducts" [product]="product">
    </app-card>
  </div>
</div>
}
<!-- Comment -->
<div class="mt-12 mx-5">
  <!-- Title -->
  <h2 class="text-3xl font-bold text-gray-800 mb-6">Customer Reviews</h2>

  <!-- Comment Form -->
  <div class="bg-white border border-gray-200 rounded-xl shadow-sm p-6 mb-8">
    <h3 class="text-lg font-semibold text-gray-700 mb-4">Write a Review</h3>
    <form
      [formGroup]="commentForm"
      (ngSubmit)="handleCommentSubmit()"
      class="space-y-5"
    >
      <div class="grid grid-cols-3 gap-x-10">
        <!-- Comment Input -->
        <div class="col-span-2">
          <label
            for="comment"
            class="block text-sm font-medium text-gray-600 mb-1"
            >Your Comment</label
          >
          <textarea
            id="comment"
            formControlName="text"
            rows="3"
            class="w-full border rounded-lg grid-cols-3 order border-gray-300 p-3 focus:ring-2 focus:ring-blue-400 focus:outline-none resize-none"
            placeholder="Share your experience..."
          ></textarea>
        </div>

        <!-- Rating Select -->
        <div class="grid-cols-1">
          <label
            for="rating"
            class="block text-sm font-medium text-gray-600 mb-1"
            >Your Rating</label
          >
          <select
            id="rating"
            formControlName="rating"
            class="w-full rounded-lg grid-cols-1 border border-gray-300 p-3 focus:ring-2 focus:ring-blue-400 focus:outline-none bg-white"
          >
            <option value="">Select Rating</option>
            <option value="1">⭐ Very Bad</option>
            <option value="2">⭐⭐ Bad</option>
            <option value="3">⭐⭐⭐ Average</option>
            <option value="4">⭐⭐⭐⭐ Good</option>
            <option value="5">⭐⭐⭐⭐⭐ Excellent</option>
          </select>
        </div>
      </div>
      <!-- Submit Button -->
      <div class="grid place-center">
        <button
          type="submit"
          [disabled]="commentForm.invalid"
          class="bg-blue-600 text-white w-100% px-6 py-2 rounded-lg hover:bg-blue-700 transition font-medium shadow-md"
        >
          Submit Review
        </button>
      </div>
    </form>
  </div>

  <!-- Reviews List -->
  @if(allComments.length > 0){
  <div class="space-y-2">
    @for(allComments of allComments ;track $index){
    <div
      class="px-5 py-2 bg-gray-50 border border-gray-200 rounded-xl shadow-sm"
      (mouseover)="handleMouseOver($index)"
    >
      <div class="flex justify-between items-center">
        <span class="font-semibold text-gray-800">{{
          allComments?.userName
        }}</span>
        <div class="flex items-between h-full flex-col justify-between">
          <span class="text-sm text-gray-500">{{
            allComments?.date | date : "mediumDate"
          }}</span>
          @if(deleteBtn === $index && allComments.userId === commentUserId ){
          <button
            mat-icon-button
            color="warn"
            aria-label="Delete comment"
            (click)="deleteComment(allComments._id)"
            class="delete-btn flex items-center justify-center w-10 h-10 rounded-full hover:bg-red-100 transition-colors"
          >
            <mat-icon class="text-red-600">delete</mat-icon>
          </button>

          }
        </div>
      </div>
      <div class="mt-1 text-yellow-500">
        <ng-container *ngFor="let star of [1, 2, 3, 4, 5]">
          <span [class.text-gray-300]="star > allComments?.rating">★</span>
        </ng-container>
      </div>
      <p class="mt-3 text-gray-700">{{ allComments?.text }}</p>
    </div>
  }
</div>

  } 
  @else{
  <!-- No Reviews Template -->
  
    <p class="text-gray-500 italic">
      No reviews yet. Be the first to leave one!
    </p>
  }
</div>
